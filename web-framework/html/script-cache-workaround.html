<script>
  //Rewrite links in a given page to avoid Edge caching when a user is logged in
  if (window.parent.document.body.className.search('previewMode') === -1) {
    function rewriteUrlNoProxyCache(i, val) {
      var url = document.createElement('a')
      url.href = val
      url.pathname += url.pathname.endsWith('/') ? "_noproxycache" : "/_noproxycache"
      return url
    }
    $('a[href*="www.jcu.edu.au"]:not([href^="mailto:"])').filter(function() {
      return !this.href.match(/\/_(admin|edit|performance|noproxycache|nocache|recache)/) && !this.href.match(/SQ_ACTION/)
    }).attr('href', rewriteUrlNoProxyCache)
    $('form[action*="www.jcu.edu.au"]').attr('action', rewriteUrlNoProxyCache)
  }
</script>
