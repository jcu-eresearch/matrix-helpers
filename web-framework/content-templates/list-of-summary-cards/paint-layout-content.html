<!--@@ Regex is the only way to (currently) get how the Content Container should be rendered @@-->
<!--@@ Pull out the first opening tag from the Content Container's rendering @@-->
<!--@@ Workaround for https://github.com/jcu-eresearch/matrix-helpers/issues/41 @@-->
<!--@@ Only show the hacked up opening tag if there's something there @@-->
%begin_asset_contents^preg_replace:379082%
%asset_contents^preg_replace:379082^replace:>:%
%else_asset%
<div
%end_begin%
    class="container content-block %globals_asset_metadata_jcu.features.theme^eq:content:jcu-content%" aria-label="%asset_metadata_template.title.title^striphtml% %asset_metadata_template.title.subtitle^striphtml%">
    <div class="row">
        <div class="col-xs-12 col-md-10 col-md-offset-1 container">

            %begin_asset_metadata_template.title.display^eq:show%
            <h3 class="%asset_metadata_template.title.alignment%">
              <script runat="server">phrasingHtmlFromKeyword('globals_asset_metadata_template.title.title:%asset_assetid%')</script>
              <script runat="server">phrasingHtmlFromKeyword('globals_asset_metadata_template.title.subtitle:%asset_assetid%', {prepend: '<br><span class="lead">', append: '</span>'})</script>
            </h3>
            %end_asset%

            <div class="row m-b-2">


        <script runat="server">
          var assetList="%asset_metadata_template.list.items%"
          var cardLayout = "%asset_metadata_template.card.layout%"

          assetList = assetList.slice(1,-1)
          var assets = assetList.split(",")

          if (cardLayout == "column")
            _.each(assets, drawCar
          else if (cardLayout == "thumbnails")
            _.each(assets, drawCard)
          else
            _.each(assets, drawCard)


          function drawCard(assetId) {
            var profileUrl = "%globals_asset_metadata_jcu.summarycard.override.url:" + assetId + "%"
            var image = 'globals_asset_metadata_jcu.summarycard.image:' + assetId
            var buttonText = "More Details"
            var target = ""
            var rel = ""
            var imageOptions = { prepend: '<img class="card-img-top" src="./?a=', append: ':v4"/>' }

 //           print('<pre>%globals_asset_metadata_jcu.summarycard.override.url:' + assetId + '%, profileUrl- ' + profileUrl + '</pre>') // debugging
 //           print('<pre>%globals_asset_metadata_jcu.summarycard.image:' + assetId + '%, image- "' + image + '"</pre>') //debugging

            print('<div class="card card-outline-secondary"><div class="card-block">')

            print('%globals_asset_metadata_jcu.summarycard.image:' + assetId + '^prepend_if:<img class="card-img-top" src="./?a=^append_if:">%')


            print('<h4 class="card-title">%globals_asset_attribute_name:' + assetId + '%</h4>')
            print('<p class="card-text">%globals_asset_metadata_jcu.summarycard.description:' + assetId + '%</p>')
            if (profileUrl == "") {
              // we will be linking to the original page within this site
              profileUrl = "./?a=" + assetId
            } else {
              // we will be linking to an external page
              target = ' target="_blank" '
              rel = ' rel="external noopener" '
            }

            print('<a class="btn btn-secondary"' + target + rel + ' href="' + profileUrl + '">' + buttonText + '</a>')
            print('</div></div>')
          }

        </script>







            </div>

            <!--@@ Buttons paint layout @@-->
            <script runat="server">
              this.args = {
                btn_wrapper: {
                  opening: '<div class="row"><div class="col-sm-12">',
                  closing: '</div></div>'
                }
              }
            </script>
            %asset_contents_paint_394551%
        </div>
    </div>

<!--@@ Pull out the last closing tag from the Content Container's rendering @@-->
<!--@@ Workaround for https://github.com/jcu-eresearch/matrix-helpers/issues/41 @@-->
%begin_asset_contents^preg_replace:379082%
%asset_contents^preg_replace:379097%
%else_asset%
</div>
%end_asset%
